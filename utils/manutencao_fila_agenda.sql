WITH t AS (
	SELECT 
		agenda.*,
		c.*
	FROM 
		edi_tms_agenda_envio agenda
		LEFT JOIN string_conexoes c
			ON c.id_string_conexao = agenda.id_banco_dados
	WHERE
		NOT EXISTS (
			SELECT
				1
			FROM
				pg_database
			WHERE
				trim(c.banco_dados) = trim(datname)
		)
		AND id_banco_dados <> 53
)
SELECT string_agg(id_banco_dados::text,',') FROM t


--DELETE FROM edi_tms_agenda_envio WHERE id_banco_dados IN (66,66,79,79,79,79,79,79,79,79,79,105,40,99)



WITH t AS (
	SELECT 
		msg.*,
		c.*
	FROM 
		msg_fila_edi msg
		LEFT JOIN string_conexoes c
			ON c.id_string_conexao = msg.id_banco_dados
	WHERE
		NOT EXISTS (
			SELECT
				1
			FROM
				pg_database
			WHERE
				trim(c.banco_dados) = trim(datname)
		)
		AND id_banco_dados <> 53
)
SELECT string_agg(id_banco_dados::text,',') FROM t


DELETE FROM msg_fila_edi WHERE id_banco_dados IN (
99,40,40,99,99,40,40,105,105,99,99,99,105,40,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,105,99,40,99,99,99,99,105,99,40,99,99,40,105,99,105,99,99,99,99,99,99,105,105,105,40,105,99,99,99,105,105,99,105,105,105,40,105,40,105,99,105,40,40,40,40,40,40,105,40,40,99,40,40,99,105,105,105,40,40,40,40,40,40,40,105,105,105,40,40,40,99,99,40,40,99,99,40,40,40,40,40,99,99,99,99,99,99,99,40,40,99,99,99,99,99,105,99,99,99,99,99,99,99,40,99,99,99,105,99,99,105,105,99,105,105,40,99,105,99,105,105,105,99,105,99,105,99,40,40,40,99,105,105,105,99,99,99,40,99,40,105,40,105,105,105,105,105,105,105,105,105,105,105,105,99,105,105,105,105,105,105,105,105,105,105,105,105,99,105,99,105,105,105,40,99,105,40,99,40,105,105,99,105,99,40,99,99,99,40,105,40,40,105,99,40,105,40,99,99,99,99,105,99,99,40,40,105,105,105,99,99,99,99,105,40,40,40,40,40,105,99,99,99,99,105,40,40,40,40,40,40,99,99,99,99,40,105,40,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,99,40,105,105,105,105,40,40,105,105,105,105,105,40,105,105,105,105,105,105,105,105,105,105,105,40,99,40,105,105,105,105,105,105,105,105,105,105,105,105,105,40,40,40,105,105,105,99,99,105,105,99,99,105,105,105,105,105,40,105,105,105,105,105,105,40,40,40,40,40,105,105,40,99,105,105,105,105,105,105,105,105,105,99,99,40,99,99,99,105,105,105,105,99,105,105,105,40,40,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,40,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,40,105,105,99,105,105,105,105,105,105,105,105,105,99,99,99,99,99,105,99,105,99,99,99,99,99,105,99,99,99,99,99,99,99
)



WITH t AS (
	SELECT 
		msg.*,
		c.*
	FROM 
		msg_fila_averb_atm msg
		LEFT JOIN string_conexoes c
			ON c.id_string_conexao = msg.id_banco_dados
	WHERE
		NOT EXISTS (
			SELECT
				1
			FROM
				pg_database
			WHERE
				trim(c.banco_dados) = trim(datname)
		)
		AND id_banco_dados <> 53
)
SELECT string_agg(id_banco_dados::text,',') FROM t


DELETE FROM msg_fila_edi WHERE id_banco_dados IN (
99,40,40,99,99,40,40,105,105,99,99,99,105,40,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,105,99,40,99,99,99,99,105,99,40,99,99,40,105,99,105,99,99,99,99,99,99,105,105,105,40,105,99,99,99,105,105,99,105,105,105,40,105,40,105,99,105,40,40,40,40,40,40,105,40,40,99,40,40,99,105,105,105,40,40,40,40,40,40,40,105,105,105,40,40,40,99,99,40,40,99,99,40,40,40,40,40,99,99,99,99,99,99,99,40,40,99,99,99,99,99,105,99,99,99,99,99,99,99,40,99,99,99,105,99,99,105,105,99,105,105,40,99,105,99,105,105,105,99,105,99,105,99,40,40,40,99,105,105,105,99,99,99,40,99,40,105,40,105,105,105,105,105,105,105,105,105,105,105,105,99,105,105,105,105,105,105,105,105,105,105,105,105,99,105,99,105,105,105,40,99,105,40,99,40,105,105,99,105,99,40,99,99,99,40,105,40,40,105,99,40,105,40,99,99,99,99,105,99,99,40,40,105,105,105,99,99,99,99,105,40,40,40,40,40,105,99,99,99,99,105,40,40,40,40,40,40,99,99,99,99,40,105,40,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,99,40,105,105,105,105,40,40,105,105,105,105,105,40,105,105,105,105,105,105,105,105,105,105,105,40,99,40,105,105,105,105,105,105,105,105,105,105,105,105,105,40,40,40,105,105,105,99,99,105,105,99,99,105,105,105,105,105,40,105,105,105,105,105,105,40,40,40,40,40,105,105,40,99,105,105,105,105,105,105,105,105,105,99,99,40,99,99,99,105,105,105,105,99,105,105,105,40,40,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,40,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,40,105,105,99,105,105,105,105,105,105,105,105,105,99,99,99,99,99,105,99,105,99,99,99,99,99,105,99,99,99,99,99,99,99
)


